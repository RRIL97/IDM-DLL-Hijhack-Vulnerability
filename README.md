# IDM-DLL-Hijhack-Vulnerability
Public disclosure
https://www.internetdownloadmanager.com/

A simple DLL Hijhack vuln that I found while I was bored & had some time. (Played with the installer of IDM on a debugger)
This potentially allows any malicious actor to run his code inside a signed process (Abuse of certificate) to bypass call chain detections of AV's.


Steps to reproduce:

1.	Open IDM Installer
2.	Breakpoint CreateFileW/DeleteFileW
3.	Notice that the installer extracts quite a lot of files under this folder:
C:\Users\%username%\AppData\Local\Temp\IDM_Setup_Temp

--------

IDM5.tmp is the file that we will be exploiting.. (x86 file)

4.	Open IDM5.TMP
5.	Breakpoint LoadLibraryW
6.  Run IDM5.TMP


![Screenshot](Git2.png)

Let's go a bit up and notice the following:

![Screenshot](Git1.png)


-------
So what is the issue?

1. GetFileAttributes (..idmvs.dll path)
2. If (File exists (..idmvs.dll path)
       CheckIfSignatureIsValid(..idmvs.dll path)
   
   LoadLibraryW(...idmvs.dll path)
   
 

